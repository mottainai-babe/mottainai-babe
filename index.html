<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>もったいないベビー｜大阪のベビー用品ゆずりあい</title>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Hiragino Sans", "Noto Sans JP", sans-serif;
      margin: 24px;
      background: #fafafa;
    }

    .card {
      max-width: 720px;
      margin: auto;
      border: 1px solid #e5e7eb;
      border-radius: 16px;
      padding: 20px;
      background: white;
    }

    h1 {
      margin-bottom: 8px;
    }

    .muted {
      color: #6b7280;
      font-size: 14px;
    }

    button {
      padding: 10px 14px;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      background: white;
      cursor: pointer;
      font-size: 14px;
    }

    button.primary {
      background: #2563eb;
      color: white;
      border: none;
    }

    .row {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    img {
      width: 48px;
      height: 48px;
      border-radius: 999px;
    }

    pre {
      background: #f9fafb;
      padding: 12px;
      border-radius: 12px;
      font-size: 12px;
    }
  </style>

</head>
<body>

<div class="card">

<h1>もったいないベビー</h1>

<p class="muted">
大阪エリア限定｜ベビー用品のゆずりあいサービス
</p>

<p class="muted">
使わなくなったベビー用品を、必要なご家庭へ。
「もったいない」を「ありがとう」に変えましょう。
</p>


<div class="row">

<button id="btnGoogle" class="primary">
Googleでログイン
</button>

<button id="btnLogout">
ログアウト
</button>

</div>


<div id="userBox" class="row" style="display:none">

<img id="photo">

<div>

<div id="name"></div>

<div class="muted" id="email"></div>

</div>

</div>


<p class="muted">システムログ</p>

<pre id="log"></pre>

</div>



<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";

import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-analytics.js";

import {

getAuth,

GoogleAuthProvider,

signInWithPopup,

onAuthStateChanged,

signOut

} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

import {

getFirestore,

doc,

setDoc,

serverTimestamp

} from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";



const firebaseConfig = {

apiKey: "AIzaSyAEk6aDtbuXU9K2bUnygYBqHMh75MeOlFU",

authDomain: "mottainai-babe.firebaseapp.com",

projectId: "mottainai-babe",

storageBucket: "mottainai-babe.firebasestorage.app",

messagingSenderId: "752649559489",

appId: "1:752649559489:web:1288d8adeef7280eb7a340",

measurementId: "G-9HNDHB2G1Q"

};



const app = initializeApp(firebaseConfig);

getAnalytics(app);



const auth = getAuth(app);

const db = getFirestore(app);

const provider = new GoogleAuthProvider();



const log = (msg) => {

document.getElementById("log").textContent

= msg + "\n" + document.getElementById("log").textContent;

};



document.getElementById("btnGoogle")

.onclick = async () => {

try {

const result = await signInWithPopup(auth, provider);

log("ログイン成功");

}

catch(e){

log("ログイン失敗");

}

};



document.getElementById("btnLogout")

.onclick = async () => {

await signOut(auth);

log("ログアウトしました");

};



onAuthStateChanged(auth, async (user)=>{

if(user){

document.getElementById("userBox").style.display="flex";

document.getElementById("name").textContent=user.displayName;

document.getElementById("email").textContent=user.email;

document.getElementById("photo").src=user.photoURL;



await setDoc(

doc(db,"users",user.uid),

{

name:user.displayName,

email:user.email,

lastLogin:serverTimestamp()

},

{merge:true}

);



log("ユーザーデータ保存完了");

}

});



</script>

    <!-- 기존 내용 -->
  </div>

  <!-- Firebase 시작 -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAEk6aDtbuXU9K2bUnygYBqHMh75MeOlFU",
      authDomain: "mottainai-babe.firebaseapp.com",
      projectId: "mottainai-babe",
      storageBucket: "mottainai-babe.firebasestorage.app",
      messagingSenderId: "752649559489",
      appId: "1:752649559489:web:1288d8adeef7280eb7a340",
      measurementId: "G-9HNDHB2G1Q"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    console.log("Firebase 初期化成功");
  </script>

</body>
</html>
