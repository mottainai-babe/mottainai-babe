<!doctype html>
<html lang="ja">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>もったいないベビー｜大阪のベビー用品ゆずりあい</title>


<style>

body{

font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP",sans-serif;

background:#fafafa;

padding:24px;

margin:0;

}


.card{

max-width:720px;

margin:auto;

background:white;

padding:24px;

border-radius:16px;

border:1px solid #e5e7eb;

}


h1{

margin-bottom:8px;

}


.muted{

color:#6b7280;

font-size:14px;

}


button{

padding:10px 16px;

border-radius:10px;

border:none;

cursor:pointer;

font-size:14px;

}


.primary{

background:#2563eb;

color:white;

}


img{

max-width:200px;

border-radius:12px;

margin-top:8px;

}


input{

padding:10px;

border-radius:10px;

border:1px solid #ddd;

width:100%;

}


.item{

margin-top:20px;

padding-top:10px;

border-top:1px solid #eee;

}


</style>

</head>


<body>



<div class="card">


<h1>もったいないベビー</h1>


<p class="muted">

大阪エリア限定｜ベビー用品のゆずりあいサービス

</p>


<p class="muted">

使わなくなったベビー用品を、必要なご家庭へ。<br>

「もったいない」を「ありがとう」に変えましょう。

</p>


<br>


<button id="loginBtn" class="primary">

Googleでログイン

</button>


<button id="logoutBtn">

ログアウト

</button>


<br><br><br>



<h3>出品する</h3>


<input type="file" id="file">

<br><br>


<input id="title" placeholder="例：ベビーカー 無料">

<br><br>


<button id="uploadBtn" class="primary">

出品する

</button>


<br><br><br>


<h3>出品一覧</h3>


<div id="list"></div>



</div>




<script type="module">


import { initializeApp }

from

"https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";



import {

getAuth,

GoogleAuthProvider,

signInWithPopup,

signOut,

onAuthStateChanged

}

from

"https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";



import {

getFirestore,

collection,

addDoc,

getDocs

}

from

"https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";



import {

getStorage,

ref,

uploadBytes,

getDownloadURL

}

from

"https://www.gstatic.com/firebasejs/12.9.0/firebase-storage.js";





const firebaseConfig={


apiKey:"AIzaSyAEk6aDtbuXU9K2bUnygYBqHMh75MeOlFU",

authDomain:"mottainai-babe.firebaseapp.com",

projectId:"mottainai-babe",

storageBucket:"mottainai-babe.firebasestorage.app",

appId:"1:752649559489:web:1288d8adeef7280eb7a340"


};



const app=initializeApp(firebaseConfig);


const auth=getAuth(app);


const db=getFirestore(app);


const storage=getStorage(app);



let currentUser=null;



loginBtn.onclick=async()=>{


const provider=new GoogleAuthProvider();


await signInWithPopup(auth,provider);


};



logoutBtn.onclick=()=>{


signOut(auth);


};



onAuthStateChanged(auth,user=>{


currentUser=user;


loadList();


});



uploadBtn.onclick=async()=>{


if(!currentUser){

alert("ログインしてください");

return;

}



const file=document.getElementById("file").files[0];


const title=document.getElementById("title").value;



if(!file||!title){

alert("画像とタイトルを入力してください");

return;

}



const storageRef=ref(storage,"items/"+Date.now());



await uploadBytes(storageRef,file);



const url=await getDownloadURL(storageRef);



await addDoc(collection(db,"items"),{


title:title,


image:url,


user:currentUser.email


});



alert("出品完了しました");



loadList();


};




async function loadList(){



const snap=await getDocs(collection(db,"items"));



list.innerHTML="";



snap.forEach(doc=>{


const data=doc.data();



list.innerHTML+=`


<div class="item">


<h4>${data.title}</h4>


<img src="${data.image}">


<p class="muted">${data.user}</p>


</div>


`;


});


}



</script>



</body>

</html>
